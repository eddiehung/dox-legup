<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>legup-4.0: MemoryBuffer.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">legup-4.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('db/dbd/MemoryBuffer_8cpp.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(13)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">MemoryBuffer.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../da/d6a/MemoryBuffer_8h_source.html">llvm/Support/MemoryBuffer.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d2/d85/SmallString_8h_source.html">llvm/ADT/SmallString.h</a>&quot;</code><br/>
<code>#include &quot;llvm/Config/config.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d9/dfd/Errc_8h_source.html">llvm/Support/Errc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../da/d5c/Errno_8h_source.html">llvm/Support/Errno.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d2/d7a/FileSystem_8h_source.html">llvm/Support/FileSystem.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d8/dab/MathExtras_8h_source.html">llvm/Support/MathExtras.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../df/d6f/Path_8h_source.html">llvm/Support/Path.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d5/d97/Process_8h_source.html">llvm/Support/Process.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d2/d66/Program_8h_source.html">llvm/Support/Program.h</a>&quot;</code><br/>
<code>#include &lt;cassert&gt;</code><br/>
<code>#include &lt;cerrno&gt;</code><br/>
<code>#include &lt;cstdio&gt;</code><br/>
<code>#include &lt;cstring&gt;</code><br/>
<code>#include &lt;new&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;system_error&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
</div>
<p><a href="../../db/dbd/MemoryBuffer_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9886e033885181e8d14e3fddce06af8c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dbd/MemoryBuffer_8cpp.html#a9886e033885181e8d14e3fddce06af8c">CopyStringRef</a> (char *<a class="el" href="../../d5/dd0/classllvm_1_1sys_1_1Memory.html">Memory</a>, <a class="el" href="../../d2/d5b/classllvm_1_1StringRef.html">StringRef</a> Data)</td></tr>
<tr class="separator:a9886e033885181e8d14e3fddce06af8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dfc85ef0ccc6ac5436e2fde94ce2562"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dbd/MemoryBuffer_8cpp.html#a2dfc85ef0ccc6ac5436e2fde94ce2562">operator new</a> (size_t <a class="el" href="../../d0/d86/regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="el" href="../../d3/d1d/X86DisassemblerTables_8h.html#abdcf78c67e79bd295d02ec20ec81ccd0">const</a> NamedBufferAlloc &amp;Alloc)</td></tr>
<tr class="separator:a2dfc85ef0ccc6ac5436e2fde94ce2562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07936f08630dd7b1943030299b1ee4a5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d4/db7/classllvm_1_1ErrorOr.html">ErrorOr</a><br class="typebreak"/>
&lt; std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="../../d5/dd0/classllvm_1_1MemoryBuffer.html">MemoryBuffer</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dbd/MemoryBuffer_8cpp.html#a07936f08630dd7b1943030299b1ee4a5">getMemoryBufferForStream</a> (int FD, <a class="el" href="../../d2/d5b/classllvm_1_1StringRef.html">StringRef</a> BufferName)</td></tr>
<tr class="separator:a07936f08630dd7b1943030299b1ee4a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cc05a5ac0842861338b6ae195c6d239"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d4/db7/classllvm_1_1ErrorOr.html">ErrorOr</a><br class="typebreak"/>
&lt; std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="../../d5/dd0/classllvm_1_1MemoryBuffer.html">MemoryBuffer</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dbd/MemoryBuffer_8cpp.html#a3cc05a5ac0842861338b6ae195c6d239">getFileAux</a> (<a class="el" href="../../d3/d1d/X86DisassemblerTables_8h.html#abdcf78c67e79bd295d02ec20ec81ccd0">const</a> char *Filename, int64_t FileSize, bool RequiresNullTerminator, bool IsVolatileSize)</td></tr>
<tr class="separator:a3cc05a5ac0842861338b6ae195c6d239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a828909a684dd5d4ffc33ef10202626b1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d4/db7/classllvm_1_1ErrorOr.html">ErrorOr</a><br class="typebreak"/>
&lt; std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="../../d5/dd0/classllvm_1_1MemoryBuffer.html">MemoryBuffer</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dbd/MemoryBuffer_8cpp.html#a828909a684dd5d4ffc33ef10202626b1">getOpenFileImpl</a> (int FD, <a class="el" href="../../d3/d1d/X86DisassemblerTables_8h.html#abdcf78c67e79bd295d02ec20ec81ccd0">const</a> char *Filename, uint64_t FileSize, uint64_t MapSize, int64_t Offset, bool RequiresNullTerminator, bool IsVolatileSize)</td></tr>
<tr class="separator:a828909a684dd5d4ffc33ef10202626b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1084fc234320c026092eec991318cb7b"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dbd/MemoryBuffer_8cpp.html#a1084fc234320c026092eec991318cb7b">shouldUseMmap</a> (int FD, size_t FileSize, size_t MapSize, off_t Offset, bool RequiresNullTerminator, int PageSize, bool IsVolatileSize)</td></tr>
<tr class="separator:a1084fc234320c026092eec991318cb7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a9886e033885181e8d14e3fddce06af8c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void CopyStringRef </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/classllvm_1_1StringRef.html">StringRef</a>&#160;</td>
          <td class="paramname"><em>Data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>CopyStringRef - Copies contents of a StringRef into a block of memory and null-terminates it. </p>

<p>Definition at line <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00060">60</a> of file <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html">MemoryBuffer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                                        {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fad5203242bc89eaa644dc7b7ba2371c1d">memcpy</a>(<a class="code" href="../../d5/dd0/classllvm_1_1sys_1_1Memory.html">Memory</a>, Data.<a class="code" href="../../d2/d5b/classllvm_1_1StringRef.html#a7d9b88d042ae1da8afd5509875c90a04">data</a>(), Data.<a class="code" href="../../d2/d5b/classllvm_1_1StringRef.html#af68d5ebdb576d7481ea2766151b875d4">size</a>());</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="../../d5/dd0/classllvm_1_1sys_1_1Memory.html">Memory</a>[Data.<a class="code" href="../../d2/d5b/classllvm_1_1StringRef.html#af68d5ebdb576d7481ea2766151b875d4">size</a>()] = 0; <span class="comment">// Null terminate string.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fad5203242bc89eaa644dc7b7ba2371c1d"><div class="ttname"><a href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fad5203242bc89eaa644dc7b7ba2371c1d">llvm::LibFunc::memcpy</a></div><div class="ttdoc">void *memcpy(void *s1, const void *s2, size_t n); </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1a/TargetLibraryInfo_8h_source.html#l00408">TargetLibraryInfo.h:408</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html_af68d5ebdb576d7481ea2766151b875d4"><div class="ttname"><a href="../../d2/d5b/classllvm_1_1StringRef.html#af68d5ebdb576d7481ea2766151b875d4">llvm::StringRef::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdoc">size - Get the string size. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd0/StringRef_8h_source.html#l00112">StringRef.h:112</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1Memory_html"><div class="ttname"><a href="../../d5/dd0/classllvm_1_1sys_1_1Memory.html">llvm::sys::Memory</a></div><div class="ttdoc">An abstraction for memory operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d5c/Memory_8h_source.html#l00045">Memory.h:45</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html_a7d9b88d042ae1da8afd5509875c90a04"><div class="ttname"><a href="../../d2/d5b/classllvm_1_1StringRef.html#a7d9b88d042ae1da8afd5509875c90a04">llvm::StringRef::data</a></div><div class="ttdeci">const char * data() const </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd0/StringRef_8h_source.html#l00106">StringRef.h:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3cc05a5ac0842861338b6ae195c6d239"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d4/db7/classllvm_1_1ErrorOr.html">ErrorOr</a>&lt; std::unique_ptr&lt; <a class="el" href="../../d5/dd0/classllvm_1_1MemoryBuffer.html">MemoryBuffer</a> &gt; &gt; getFileAux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d1d/X86DisassemblerTables_8h.html#abdcf78c67e79bd295d02ec20ec81ccd0">const</a> char *&#160;</td>
          <td class="paramname"><em>Filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>FileSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>RequiresNullTerminator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>IsVolatileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00249">249</a> of file <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html">MemoryBuffer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordtype">int</span> FD;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  std::error_code EC = <a class="code" href="../../d7/d18/namespacellvm_1_1sys_1_1fs.html#adfde2656f5c50d80eb5258d7bb15b58b">sys::fs::openFileForRead</a>(Filename, FD);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">if</span> (EC)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span> EC;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="../../d4/db7/classllvm_1_1ErrorOr.html">ErrorOr&lt;std::unique_ptr&lt;MemoryBuffer&gt;</a>&gt; <a class="code" href="../../d3/dba/namespacellvm_1_1MipsISD.html#a7a7035feda1dc16252a7a15a7e230122a366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> =</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="../../db/dbd/MemoryBuffer_8cpp.html#a828909a684dd5d4ffc33ef10202626b1">getOpenFileImpl</a>(FD, Filename, FileSize, FileSize, 0,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                      RequiresNullTerminator, IsVolatileSize);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  close(FD);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d3/dba/namespacellvm_1_1MipsISD.html#a7a7035feda1dc16252a7a15a7e230122a366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div>
<div class="ttc" id="classllvm_1_1ErrorOr_html"><div class="ttname"><a href="../../d4/db7/classllvm_1_1ErrorOr.html">llvm::ErrorOr</a></div><div class="ttdoc">Represents either an error or a value T. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d70/ErrorOr_8h_source.html#l00082">ErrorOr.h:82</a></div></div>
<div class="ttc" id="MemoryBuffer_8cpp_html_a828909a684dd5d4ffc33ef10202626b1"><div class="ttname"><a href="../../db/dbd/MemoryBuffer_8cpp.html#a828909a684dd5d4ffc33ef10202626b1">getOpenFileImpl</a></div><div class="ttdeci">static ErrorOr&lt; std::unique_ptr&lt; MemoryBuffer &gt; &gt; getOpenFileImpl(int FD, const char *Filename, uint64_t FileSize, uint64_t MapSize, int64_t Offset, bool RequiresNullTerminator, bool IsVolatileSize)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00312">MemoryBuffer.cpp:312</a></div></div>
<div class="ttc" id="namespacellvm_1_1MipsISD_html_a7a7035feda1dc16252a7a15a7e230122a366e1eac31eeb1a1892d62ccfc0c8cf8"><div class="ttname"><a href="../../d3/dba/namespacellvm_1_1MipsISD.html#a7a7035feda1dc16252a7a15a7e230122a366e1eac31eeb1a1892d62ccfc0c8cf8">llvm::MipsISD::Ret</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/MipsISelLowering_8h_source.html#l00067">MipsISelLowering.h:67</a></div></div>
<div class="ttc" id="namespacellvm_1_1sys_1_1fs_html_adfde2656f5c50d80eb5258d7bb15b58b"><div class="ttname"><a href="../../d7/d18/namespacellvm_1_1sys_1_1fs.html#adfde2656f5c50d80eb5258d7bb15b58b">llvm::sys::fs::openFileForRead</a></div><div class="ttdeci">std::error_code openFileForRead(const Twine &amp;Name, int &amp;ResultFD)</div><div class="ttdoc">Does file exist? </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a07936f08630dd7b1943030299b1ee4a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d4/db7/classllvm_1_1ErrorOr.html">ErrorOr</a>&lt;std::unique_ptr&lt;<a class="el" href="../../d5/dd0/classllvm_1_1MemoryBuffer.html">MemoryBuffer</a>&gt; &gt; getMemoryBufferForStream </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/classllvm_1_1StringRef.html">StringRef</a>&#160;</td>
          <td class="paramname"><em>BufferName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00209">209</a> of file <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html">MemoryBuffer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                                       {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keyword">const</span> ssize_t ChunkSize = 4096*4;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="../../db/ddb/classllvm_1_1SmallString.html">SmallString&lt;ChunkSize&gt;</a> Buffer;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  ssize_t ReadBytes;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// Read into Buffer until we hit EOF.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    Buffer.<a class="code" href="../../da/d30/classllvm_1_1SmallVectorImpl.html#a4786e64977a3af38f29adee46b70a863">reserve</a>(Buffer.<a class="code" href="../../d4/d68/classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() + ChunkSize);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    ReadBytes = <a class="code" href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa4221e6a39514fc71dccdd041ed704979">read</a>(FD, Buffer.<a class="code" href="../../d4/d68/classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(), ChunkSize);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (ReadBytes == -1) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">if</span> (errno == EINTR) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">return</span> std::error_code(errno, std::generic_category());</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    Buffer.<a class="code" href="../../da/d30/classllvm_1_1SmallVectorImpl.html#a45bab6d91cf74da99624723b65bd0e5b">set_size</a>(Buffer.<a class="code" href="../../d4/d68/classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() + ReadBytes);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  } <span class="keywordflow">while</span> (ReadBytes != 0);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  std::unique_ptr&lt;MemoryBuffer&gt; <a class="code" href="../../d3/dba/namespacellvm_1_1MipsISD.html#a7a7035feda1dc16252a7a15a7e230122a366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>(</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      MemoryBuffer::getMemBufferCopy(Buffer, BufferName));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">return</span> std::move(<a class="code" href="../../d3/dba/namespacellvm_1_1MipsISD.html#a7a7035feda1dc16252a7a15a7e230122a366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a075e34e98605d0e7c289763a104869ac"><div class="ttname"><a href="../../d4/d68/classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">llvm::SmallVectorTemplateCommon&lt; T &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d33/SmallVector_8h_source.html#l00115">SmallVector.h:115</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="../../d4/d68/classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon&lt; T &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d33/SmallVector_8h_source.html#l00128">SmallVector.h:128</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a45bab6d91cf74da99624723b65bd0e5b"><div class="ttname"><a href="../../da/d30/classllvm_1_1SmallVectorImpl.html#a45bab6d91cf74da99624723b65bd0e5b">llvm::SmallVectorImpl&lt; char &gt;::set_size</a></div><div class="ttdeci">void set_size(unsigned N)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d33/SmallVector_8h_source.html#l00669">SmallVector.h:669</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a4786e64977a3af38f29adee46b70a863"><div class="ttname"><a href="../../da/d30/classllvm_1_1SmallVectorImpl.html#a4786e64977a3af38f29adee46b70a863">llvm::SmallVectorImpl&lt; char &gt;::reserve</a></div><div class="ttdeci">void reserve(unsigned N)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d33/SmallVector_8h_source.html#l00401">SmallVector.h:401</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa4221e6a39514fc71dccdd041ed704979"><div class="ttname"><a href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa4221e6a39514fc71dccdd041ed704979">llvm::LibFunc::read</a></div><div class="ttdoc">ssize_t read(int fildes, void *buf, size_t nbyte); </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1a/TargetLibraryInfo_8h_source.html#l00474">TargetLibraryInfo.h:474</a></div></div>
<div class="ttc" id="classllvm_1_1SmallString_html"><div class="ttname"><a href="../../db/ddb/classllvm_1_1SmallString.html">llvm::SmallString</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/SmallString_8h_source.html#l00025">SmallString.h:25</a></div></div>
<div class="ttc" id="namespacellvm_1_1MipsISD_html_a7a7035feda1dc16252a7a15a7e230122a366e1eac31eeb1a1892d62ccfc0c8cf8"><div class="ttname"><a href="../../d3/dba/namespacellvm_1_1MipsISD.html#a7a7035feda1dc16252a7a15a7e230122a366e1eac31eeb1a1892d62ccfc0c8cf8">llvm::MipsISD::Ret</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/MipsISelLowering_8h_source.html#l00067">MipsISelLowering.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a828909a684dd5d4ffc33ef10202626b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d4/db7/classllvm_1_1ErrorOr.html">ErrorOr</a>&lt; std::unique_ptr&lt; <a class="el" href="../../d5/dd0/classllvm_1_1MemoryBuffer.html">MemoryBuffer</a> &gt; &gt; getOpenFileImpl </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d1d/X86DisassemblerTables_8h.html#abdcf78c67e79bd295d02ec20ec81ccd0">const</a> char *&#160;</td>
          <td class="paramname"><em>Filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>FileSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>MapSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>RequiresNullTerminator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>IsVolatileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00312">312</a> of file <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html">MemoryBuffer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                     {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> PageSize = sys::process::get_self()-&gt;page_size();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// Default is to map the full file.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">if</span> (MapSize == uint64_t(-1)) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// If we don&#39;t know the file size, use fstat to find out.  fstat on an open</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// file descriptor is cheaper than stat on a random path.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (FileSize == uint64_t(-1)) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <a class="code" href="../../d1/d87/classllvm_1_1sys_1_1fs_1_1file__status.html">sys::fs::file_status</a> <a class="code" href="../../de/d5a/namespacellvm_1_1zlib.html#ae682ea6618e32d6e5365418a2e07424d">Status</a>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      std::error_code EC = <a class="code" href="../../d7/d18/namespacellvm_1_1sys_1_1fs.html#a7e45efa8293acb95e465074828c36f38">sys::fs::status</a>(FD, Status);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">if</span> (EC)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">return</span> EC;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">// If this not a file or a block device (e.g. it&#39;s a named pipe</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="comment">// or character device), we can&#39;t trust the size. Create the memory</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="comment">// buffer by copying off the stream.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <a class="code" href="../../d7/d18/namespacellvm_1_1sys_1_1fs.html#a6c50be965db24d7532b6b4e6b0755f5c">sys::fs::file_type</a> <a class="code" href="../../db/d53/classllvm_1_1Type.html">Type</a> = Status.<a class="code" href="../../d1/d87/classllvm_1_1sys_1_1fs_1_1file__status.html#acdc2afb012409b8d58bc578526228d0c">type</a>();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">if</span> (Type != sys::fs::file_type::regular_file &amp;&amp;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;          Type != sys::fs::file_type::block_file)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dbd/MemoryBuffer_8cpp.html#a07936f08630dd7b1943030299b1ee4a5">getMemoryBufferForStream</a>(FD, Filename);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      FileSize = Status.getSize();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    MapSize = FileSize;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../db/dbd/MemoryBuffer_8cpp.html#a1084fc234320c026092eec991318cb7b">shouldUseMmap</a>(FD, FileSize, MapSize, Offset, RequiresNullTerminator,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    PageSize, IsVolatileSize)) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    std::error_code EC;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    std::unique_ptr&lt;MemoryBuffer&gt; Result(</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keyword">new</span> (NamedBufferAlloc(Filename))</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        MemoryBufferMMapFile(RequiresNullTerminator, FD, MapSize, Offset, EC));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (!EC)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">return</span> std::move(Result);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="../../d5/dd0/classllvm_1_1MemoryBuffer.html">MemoryBuffer</a> *Buf = MemoryBuffer::getNewUninitMemBuffer(MapSize, Filename);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> (!Buf) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// Failed to create a buffer. The only way it can fail is if</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// new(std::nothrow) returns 0.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/namespacellvm_1_1object.html#a43b32457aea71dc0620247d9e865e1b5">make_error_code</a>(errc::not_enough_memory);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  std::unique_ptr&lt;MemoryBuffer&gt; SB(Buf);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">char</span> *BufPtr = <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(SB-&gt;getBufferStart());</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">size_t</span> BytesLeft = MapSize;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#ifndef HAVE_PREAD</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (lseek(FD, Offset, SEEK_SET) == -1)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">return</span> std::error_code(errno, std::generic_category());</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">while</span> (BytesLeft) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">#ifdef HAVE_PREAD</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor"></span>    ssize_t NumRead = <a class="code" href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa72f21237f944370c194d5cfa5afe2665">::pread</a>(FD, BufPtr, BytesLeft, MapSize-BytesLeft+Offset);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor"></span>    ssize_t NumRead = <a class="code" href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa4221e6a39514fc71dccdd041ed704979">::read</a>(FD, BufPtr, BytesLeft);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (NumRead == -1) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keywordflow">if</span> (errno == EINTR)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="comment">// Error while reading.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">return</span> std::error_code(errno, std::generic_category());</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (NumRead == 0) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <a class="code" href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa9f7f1b6be1144152902121f2463d0368">memset</a>(BufPtr, 0, BytesLeft); <span class="comment">// zero-initialize rest of the buffer.</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    BytesLeft -= NumRead;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    BufPtr += NumRead;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">return</span> std::move(SB);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="ttc" id="namespacellvm_1_1object_html_a43b32457aea71dc0620247d9e865e1b5"><div class="ttname"><a href="../../dc/db0/namespacellvm_1_1object.html#a43b32457aea71dc0620247d9e865e1b5">llvm.object::make_error_code</a></div><div class="ttdeci">std::error_code make_error_code(object_error e)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d3b/include_2llvm_2Object_2Error_8h_source.html#l00032">include/llvm/Object/Error.h:32</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa4221e6a39514fc71dccdd041ed704979"><div class="ttname"><a href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa4221e6a39514fc71dccdd041ed704979">llvm::LibFunc::read</a></div><div class="ttdoc">ssize_t read(int fildes, void *buf, size_t nbyte); </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1a/TargetLibraryInfo_8h_source.html#l00474">TargetLibraryInfo.h:474</a></div></div>
<div class="ttc" id="MemoryBuffer_8cpp_html_a1084fc234320c026092eec991318cb7b"><div class="ttname"><a href="../../db/dbd/MemoryBuffer_8cpp.html#a1084fc234320c026092eec991318cb7b">shouldUseMmap</a></div><div class="ttdeci">static bool shouldUseMmap(int FD, size_t FileSize, size_t MapSize, off_t Offset, bool RequiresNullTerminator, int PageSize, bool IsVolatileSize)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00263">MemoryBuffer.cpp:263</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1fs_1_1file__status_html"><div class="ttname"><a href="../../d1/d87/classllvm_1_1sys_1_1fs_1_1file__status.html">llvm::sys::fs::file_status</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d7a/FileSystem_8h_source.html#l00138">FileSystem.h:138</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa72f21237f944370c194d5cfa5afe2665"><div class="ttname"><a href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa72f21237f944370c194d5cfa5afe2665">llvm::LibFunc::pread</a></div><div class="ttdoc">ssize_t pread(int fildes, void *buf, size_t nbyte, off_t offset); </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1a/TargetLibraryInfo_8h_source.html#l00458">TargetLibraryInfo.h:458</a></div></div>
<div class="ttc" id="namespacellvm_1_1zlib_html_ae682ea6618e32d6e5365418a2e07424d"><div class="ttname"><a href="../../de/d5a/namespacellvm_1_1zlib.html#ae682ea6618e32d6e5365418a2e07424d">llvm::zlib::Status</a></div><div class="ttdeci">Status</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d9c/Compression_8h_source.html#l00034">Compression.h:34</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="../../db/d53/classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db7/Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa9f7f1b6be1144152902121f2463d0368"><div class="ttname"><a href="../../d2/d4d/namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa9f7f1b6be1144152902121f2463d0368">llvm::LibFunc::memset</a></div><div class="ttdoc">void *memset(void *b, int c, size_t len); </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1a/TargetLibraryInfo_8h_source.html#l00414">TargetLibraryInfo.h:414</a></div></div>
<div class="ttc" id="classllvm_1_1MemoryBuffer_html"><div class="ttname"><a href="../../d5/dd0/classllvm_1_1MemoryBuffer.html">llvm::MemoryBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d6a/MemoryBuffer_8h_source.html#l00037">MemoryBuffer.h:37</a></div></div>
<div class="ttc" id="MemoryBuffer_8cpp_html_a07936f08630dd7b1943030299b1ee4a5"><div class="ttname"><a href="../../db/dbd/MemoryBuffer_8cpp.html#a07936f08630dd7b1943030299b1ee4a5">getMemoryBufferForStream</a></div><div class="ttdeci">static ErrorOr&lt; std::unique_ptr&lt; MemoryBuffer &gt; &gt; getMemoryBufferForStream(int FD, StringRef BufferName)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00209">MemoryBuffer.cpp:209</a></div></div>
<div class="ttc" id="namespacellvm_1_1sys_1_1fs_html_a6c50be965db24d7532b6b4e6b0755f5c"><div class="ttname"><a href="../../d7/d18/namespacellvm_1_1sys_1_1fs.html#a6c50be965db24d7532b6b4e6b0755f5c">llvm::sys::fs::file_type</a></div><div class="ttdeci">file_type</div><div class="ttdoc">An enumeration for the file system&#39;s view of the type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d7a/FileSystem_8h_source.html#l00053">FileSystem.h:53</a></div></div>
<div class="ttc" id="namespacellvm_1_1sys_1_1fs_html_a7e45efa8293acb95e465074828c36f38"><div class="ttname"><a href="../../d7/d18/namespacellvm_1_1sys_1_1fs.html#a7e45efa8293acb95e465074828c36f38">llvm::sys::fs::status</a></div><div class="ttdeci">std::error_code status(const Twine &amp;path, file_status &amp;result)</div><div class="ttdoc">Get file status as if by POSIX stat(). </div></div>
<div class="ttc" id="classllvm_1_1sys_1_1fs_1_1file__status_html_acdc2afb012409b8d58bc578526228d0c"><div class="ttname"><a href="../../d1/d87/classllvm_1_1sys_1_1fs_1_1file__status.html#acdc2afb012409b8d58bc578526228d0c">llvm::sys::fs::file_status::type</a></div><div class="ttdeci">file_type type() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d7a/FileSystem_8h_source.html#l00196">FileSystem.h:196</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2dfc85ef0ccc6ac5436e2fde94ce2562"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* operator new </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d1d/X86DisassemblerTables_8h.html#abdcf78c67e79bd295d02ec20ec81ccd0">const</a> NamedBufferAlloc &amp;&#160;</td>
          <td class="paramname"><em>Alloc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00072">72</a> of file <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html">MemoryBuffer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                                            {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">char</span> *Mem = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(<span class="keyword">operator</span> <span class="keyword">new</span>(<a class="code" href="../../d0/d86/regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> + Alloc.Name.size() + 1));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="../../db/dbd/MemoryBuffer_8cpp.html#a9886e033885181e8d14e3fddce06af8c">CopyStringRef</a>(Mem + <a class="code" href="../../d0/d86/regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, Alloc.Name);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">return</span> Mem;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
<div class="ttc" id="MemoryBuffer_8cpp_html_a9886e033885181e8d14e3fddce06af8c"><div class="ttname"><a href="../../db/dbd/MemoryBuffer_8cpp.html#a9886e033885181e8d14e3fddce06af8c">CopyStringRef</a></div><div class="ttdeci">static void CopyStringRef(char *Memory, StringRef Data)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00060">MemoryBuffer.cpp:60</a></div></div>
<div class="ttc" id="regcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="../../d0/d86/regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1084fc234320c026092eec991318cb7b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool shouldUseMmap </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>FileSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>MapSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&#160;</td>
          <td class="paramname"><em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>RequiresNullTerminator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>PageSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>IsVolatileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html#l00263">263</a> of file <a class="el" href="../../db/dbd/MemoryBuffer_8cpp_source.html">MemoryBuffer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                               {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">// mmap may leave the buffer without null terminator if the file size changed</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">// by the time the last page is mapped in, so avoid it if the file size is</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// likely to change.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">if</span> (IsVolatileSize)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// We don&#39;t use mmap for small files because this can severely fragment our</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// address space.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">if</span> (MapSize &lt; 4 * 4096 || MapSize &lt; (<span class="keywordtype">unsigned</span>)PageSize)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">if</span> (!RequiresNullTerminator)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// If we don&#39;t know the file size, use fstat to find out.  fstat on an open</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// file descriptor is cheaper than stat on a random path.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">// FIXME: this chunk of code is duplicated, but it avoids a fstat when</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// RequiresNullTerminator = false and MapSize != -1.</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">if</span> (FileSize == <span class="keywordtype">size_t</span>(-1)) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="../../d1/d87/classllvm_1_1sys_1_1fs_1_1file__status.html">sys::fs::file_status</a> <a class="code" href="../../de/d5a/namespacellvm_1_1zlib.html#ae682ea6618e32d6e5365418a2e07424d">Status</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/d18/namespacellvm_1_1sys_1_1fs.html#a7e45efa8293acb95e465074828c36f38">sys::fs::status</a>(FD, Status))</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    FileSize = Status.getSize();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// If we need a null terminator and the end of the map is inside the file,</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// we cannot use mmap.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordtype">size_t</span> End = Offset + MapSize;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="../../df/dca/GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(End &lt;= FileSize);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">if</span> (End != FileSize)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">// Don&#39;t try to map files that are exactly a multiple of the system page size</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// if we need a null terminator.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">if</span> ((FileSize &amp; (PageSize -1)) == 0)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;}</div>
<div class="ttc" id="classllvm_1_1sys_1_1fs_1_1file__status_html"><div class="ttname"><a href="../../d1/d87/classllvm_1_1sys_1_1fs_1_1file__status.html">llvm::sys::fs::file_status</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d7a/FileSystem_8h_source.html#l00138">FileSystem.h:138</a></div></div>
<div class="ttc" id="namespacellvm_1_1zlib_html_ae682ea6618e32d6e5365418a2e07424d"><div class="ttname"><a href="../../de/d5a/namespacellvm_1_1zlib.html#ae682ea6618e32d6e5365418a2e07424d">llvm::zlib::Status</a></div><div class="ttdeci">Status</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d9c/Compression_8h_source.html#l00034">Compression.h:34</a></div></div>
<div class="ttc" id="GlobalMerge_8cpp_html_a65c1240c404c646dd0e63fdcbf620730"><div class="ttname"><a href="../../df/dca/GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a></div><div class="ttdeci">assert(Globals.size() &gt; 1)</div></div>
<div class="ttc" id="namespacellvm_1_1sys_1_1fs_html_a7e45efa8293acb95e465074828c36f38"><div class="ttname"><a href="../../d7/d18/namespacellvm_1_1sys_1_1fs.html#a7e45efa8293acb95e465074828c36f38">llvm::sys::fs::status</a></div><div class="ttdeci">std::error_code status(const Twine &amp;path, file_status &amp;result)</div><div class="ttdoc">Get file status as if by POSIX stat(). </div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_211fb134ce6a4c3329568c5b3817f0ae.html">llvm</a></li><li class="navelem"><a class="el" href="../../dir_68ef2609279916640dd02c22eb347286.html">lib</a></li><li class="navelem"><a class="el" href="../../dir_bf017854dca758d5bcbca19bbbbe9c48.html">Support</a></li><li class="navelem"><a class="el" href="../../db/dbd/MemoryBuffer_8cpp.html">MemoryBuffer.cpp</a></li>
    <li class="footer">Generated on Thu Oct 8 2015 11:44:49 for legup-4.0 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
